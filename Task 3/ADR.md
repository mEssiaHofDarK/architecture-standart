###  **Название задачи:** Task 3
###  **Автор:** Я
###  **Дата:** вставить любую
###  **Функциональные требования**

| **№** | **Действующие лица или системы**                                         | **Use Case**                                 | **Описание**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|:-----:|:-------------------------------------------------------------------------|:---------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|   1   | Клиент, сайт, кафка, crm, менеджер колл-центра, АБС, менеджер бек-офиса  | Подача заявки на депозит на сайте            | 1. Клиент заходит на сайт и оставляет заявку на депозит, заполняя ФИО и номер телефона<br/>2. Заявка попадает в топик в кафке<br/> 3. CRM собирает заявки из топика<br/>4. Клиенту звонит менеджер колл-центра для уточнения деталей заявки и возможно предложения персональных предложений<br/>5. Менеджер подтверждает заявку в CRM<br/>6. Заявка отправляется в АБС<br/>7. Менеджер бек-офиса согласовывает заявку<br/>8. Клиенту приходит СМС сообщение о готовности<br/>9. Клиент приходит в банк для подписания документов |
|   2   | Клиент, менеджер бек-офиса                                               | Подача заявки на депозит через интернет-банк | 1. Клиент заходит в интернет-банк и оставляет заявку на депозит, указав сумму и счёт для депозита<br/>2.Клиент подтверждает операцию через СМС<br/>3. Заявка попадает в топик в кафке<br/>4. Из топика заявка попадает в АБС<br/>5. Менеджер бек-офиса согласовывает заявку<br/>6. Клиенту приходит СМС о готовности<br/>7. Клиент приходит в банк для подписания документов                                                                                                                                                     |


### **Нефункциональные требования**

| **№** | **Требование**                                                                                                        |
|:-----:|:----------------------------------------------------------------------------------------------------------------------|
|   1   | Все сервисы должны работать 24/7                                                                                      |
|   2   | Все сервисы должны быть доступны в 99,9% случаев                                                                      |
|   3   | Отклик по всем операциям должен быть максимально быстрым                                                              |
|   4   | Предусмотреть равномерное горизонтальное масштабирование и распределение запросов между серверами, приложениями и ЦОД |
|   5   | Передача чувствительной информации должна производиться с шифрованием                                                 |
|   6   | При доработках во всех системах нужно стараться использовать технологии, которые уже есть в банке                     |
|   7   | При использовании новых технологий, гарантировать совместимость с существующими                                       |
|   8   | При использовании новых технологий, должны быть сотрудники, имеющие экспертизу в них                                  |
|   9   | Функционал работы с СМС необходимо доработать                                                                         |


### **Решение**
Диаграмма контекста https://github.com/mEssiaHofDarK/architecture-standart/blob/work/Task%203/context.puml

Диаграмма контейнеров https://github.com/mEssiaHofDarK/architecture-standart/blob/work/Task%203/container.puml

Для стабильности решил прикрутить кафку. Чтобы не уронить нагруженный АБС, в консьюмерах можно сделать троттлинг для контроля количества запросов. Также для обработки заявок с сайта было принято решение ввести в эксплуатацию CRM из функционала колл-центра. Это также в последствии может поспособствовать отказу от устаревшей АБС и по системе ролей ограничить доступы разных отделов.
###  **Альтернативы**
Как альтернатива - не использовать кафку, а всё завязать на АБС. Но при таком подходе придётся очень сильно вертикально промасштабировать АБС, и это не даст гарантии избежания отказа АБС от перегрузки. 

**Недостатки, ограничения, риски**

Узкое место в данной архитектуре это общение АБС и кафки, т.к. АБС сильно загружена и заявки могут идти с задержкой. Но это обусловлено требованием, что заявки должен согласовывать менеджер бек-офиса. Второй трудный момент это СМС подтверждение из интернет-банка. Для первоначального упрощения можно наладить общение с телеком шлюзом по примеру АБС. В последствии можно доработать ядро, т.к. там есть функционал работы с СМС оповещениями. 

